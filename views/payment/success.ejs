<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title><%= title || 'Success - IAAI Training Institute' %></title>
    <link rel="stylesheet" href="/css/checkoutstyle.css">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        /* Your existing styles */
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            font-family: 'Montserrat', sans-serif; 
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }
        
        main { flex: 1; display: flex; align-items: center; justify-content: center; padding: 20px; }
        
        .success-container {
            background: white;
            padding: 50px 40px;
            border-radius: 20px;
            text-align: center;
            box-shadow: 0 20px 40px rgba(0,0,0,0.15);
            max-width: 700px;
            width: 100%;
            position: relative;
            overflow: hidden;
        }
        
        .success-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 5px;
            background: linear-gradient(90deg, #28a745, #20c997, #17a2b8);
        }
        
        .success-icon {
            width: 120px;
            height: 120px;
            background: linear-gradient(135deg, #28a745, #20c997);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 30px;
            animation: pulse 2s infinite;
            box-shadow: 0 10px 30px rgba(40, 167, 69, 0.3);
        }
        
        .success-icon i { font-size: 60px; color: white; }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        
        h1 { color: #333; margin-bottom: 15px; font-size: 36px; font-weight: 700; }
        
        .subtitle { color: #666; font-size: 18px; margin-bottom: 30px; line-height: 1.5; }
        
        .order-details {
            background: #f8f9fa;
            padding: 30px;
            border-radius: 15px;
            margin: 30px 0;
            border-left: 5px solid #28a745;
            text-align: left;
        }
        
        .order-details h3 {
            color: #333;
            margin-bottom: 20px;
            font-size: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .detail-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .detail-item {
            display: flex;
            justify-content: space-between;
            padding: 12px 0;
            border-bottom: 1px solid #eee;
        }
        
        .detail-label { font-weight: 500; color: #666; }
        .detail-value { font-weight: 600; color: #333; }
        
        .amount-display {
            font-size: 28px;
            color: #28a745;
            font-weight: 700;
            text-align: center;
            padding: 25px;
            background: linear-gradient(135deg, #d4edda, #c3e6cb);
            border-radius: 15px;
            margin: 20px 0;
            border: 3px solid #28a745;
        }
        
        .free-registration {
            background: linear-gradient(135deg, #e3f2fd, #bbdefb);
            border-color: #2196f3;
            color: #0d47a1;
        }
        
        .buttons {
            display: flex;
            gap: 20px;
            justify-content: center;
            margin-top: 40px;
            flex-wrap: wrap;
        }
        
        .btn {
            padding: 15px 30px;
            border: none;
            border-radius: 10px;
            text-decoration: none;
            font-weight: 600;
            font-size: 16px;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 10px;
            cursor: pointer;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #007bff, #0056b3);
            color: white;
            box-shadow: 0 4px 15px rgba(0, 123, 255, 0.3);
        }
        
        .btn-secondary {
            background: linear-gradient(135deg, #6c757d, #545b62);
            color: white;
            box-shadow: 0 4px 15px rgba(108, 117, 125, 0.3);
        }
        
        .btn-success {
            background: linear-gradient(135deg, #28a745, #20c997);
            color: white;
            box-shadow: 0 4px 15px rgba(40, 167, 69, 0.3);
        }
        
        .btn:hover { transform: translateY(-2px); }
        
        .payment-method {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            background: #f8f9fa;
            padding: 8px 12px;
            border-radius: 20px;
            font-size: 14px;
            color: #495057;
            border: 1px solid #dee2e6;
        }
        
        .status-badge {
            background: #28a745;
            color: white;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: 600;
            display: inline-flex;
            align-items: center;
            gap: 6px;
        }
        
        @media (max-width: 768px) {
            .success-container { padding: 30px 20px; margin: 10px; }
            .detail-grid { grid-template-columns: 1fr; }
            .buttons { flex-direction: column; align-items: center; }
            .btn { width: 100%; max-width: 300px; justify-content: center; }
            h1 { font-size: 28px; }
        }
    </style>
</head>
<body>
    <%- include('../partials/header') %>

    <main>
        <div class="success-container">
            <div class="success-icon">
                <i class="fas fa-check"></i>
            </div>
            
            <!-- ‚úÖ Dynamic title based on free vs paid -->
            <% 
            const isFree = (typeof amount !== 'undefined' && (amount === '0.00' || order_id === 'FREE'));
            %>
            
            <h1>
                <% if (isFree) { %>
                    üéâ Registration Successful!
                <% } else { %>
                    üéâ Payment Successful!
                <% } %>
            </h1>
            
            <p class="subtitle">
                <% if (isFree) { %>
                    Thank you for registering! Your courses have been activated and you now have full access to your enrolled programs.
                <% } else { %>
                    Thank you for your payment! Your transaction has been processed successfully and you now have full access to your enrolled courses.
                <% } %>
            </p>
            
            <div class="order-details">
                <h3>
                    <i class="fas fa-<%= isFree ? 'graduation-cap' : 'receipt' %>"></i> 
                    <%= isFree ? 'Registration' : 'Payment' %> Details
                </h3>
                
                <div class="detail-grid">
                    <% if (typeof order_id !== 'undefined') { %>
                    <div class="detail-item">
                        <span class="detail-label">Order ID:</span>
                        <span class="detail-value"><%= order_id %></span>
                    </div>
                    <% } %>
                    
                    <% if (referenceNumber) { %>
                    <div class="detail-item">
                        <span class="detail-label">Reference Number:</span>
                        <span class="detail-value"><%= referenceNumber %></span>
                    </div>
                    <% } %>
                    
                    <div class="detail-item">
                        <span class="detail-label"><%= isFree ? 'Registration' : 'Payment' %> Date:</span>
                        <span class="detail-value"><%= new Date().toLocaleDateString() %></span>
                    </div>
                    
                    <div class="detail-item">
                        <span class="detail-label">Status:</span>
                        <span class="detail-value">
                            <span class="status-badge">
                                <i class="fas fa-check-circle"></i> Completed
                            </span>
                        </span>
                    </div>
                    
                    <div class="detail-item">
                        <span class="detail-label">Method:</span>
                        <span class="detail-value">
                            <% if (isFree) { %>
                                <span class="payment-method">
                                    <i class="fas fa-gift"></i> Free Registration
                                </span>
                            <% } else { %>
                                <span class="payment-method">
                                    <i class="fas fa-credit-card"></i> CCAvenue Payment Gateway
                                </span>
                            <% } %>
                        </span>
                    </div>
                </div>
                
                <% if (typeof amount !== 'undefined') { %>
                <div class="amount-display <%= isFree ? 'free-registration' : '' %>">
                    <% if (isFree) { %>
                        üéÅ Registration Completed: FREE
                    <% } else { %>
                        üí≥ Amount Paid: $<%= amount %> USD
                    <% } %>
                </div>
                <% } %>
            </div>
            
            <div class="buttons">
                <a href="/my-courses" class="btn btn-primary">
                    <i class="fas fa-graduation-cap"></i> View My Courses
                </a>
                <a href="/dashboard" class="btn btn-success">
                    <i class="fas fa-tachometer-alt"></i> Go to Dashboard
                </a>
                <a href="/training-programs" class="btn btn-secondary">
                    <i class="fas fa-search"></i> Browse More Courses
                </a>
            </div>
        </div>
    </main>

    <%- include('../partials/footer') %>

    <script>
        const isFree = <%= JSON.stringify(isFree) %>;
        console.log(isFree ? 'üéÅ Free registration successful!' : 'üí≥ Payment successful!');
        <% if (referenceNumber) { %>
        console.log('üìù Reference Number:', '<%= referenceNumber %>');
        <% } %>
        <% if (typeof order_id !== 'undefined') { %>
        console.log('üõí Order ID:', '<%= order_id %>');
        <% } %>
    </script>
</body>
</html>