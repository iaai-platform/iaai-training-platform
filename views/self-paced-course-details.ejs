<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title><%= course.basic?.title || course.title || 'Course' %> - Self-Paced Online Training</title>
  <meta name="description" content="<%= course.basic.description %>">
  <!-- Social Media Preview Tags -->
  <meta property="og:title" content="<%= course.basic.title %>">
  <meta property="og:description" content="<%= course.basic.description %>">
  <meta property="og:image" content="<%= course.media && course.media.thumbnailUrl ? course.media.thumbnailUrl : '/images/IAAI-Logo.jpg' %>">
  <meta property="og:url" content="http://localhost:3000/self-paced-online-training/courses/<%= course._id %>">
  
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700&family=Montserrat:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
  
  <style>
    /* Reset and Base Styles */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: 'Montserrat', sans-serif;
      background-color: #f9f9f9;
      color: #333;
      line-height: 1.6;
    }
    
    /* Breadcrumb Styling */
    .breadcrumb {
      margin: 0;
      padding: 20px 5%;
      background: linear-gradient(to right, rgba(0, 33, 71, 0.05), rgba(184, 134, 11, 0.05));
      font-size: 14px;
      backdrop-filter: blur(10px);
    }
    
    .breadcrumb a {
      color: #002147;
      text-decoration: none;
      font-weight: 500;
      transition: all 0.3s ease;
      position: relative;
    }
    
    .breadcrumb a::after {
      content: '';
      position: absolute;
      bottom: -2px;
      left: 0;
      width: 0;
      height: 2px;
      background-color: #b8860b;
      transition: width 0.3s ease;
    }
    
    .breadcrumb a:hover::after {
      width: 100%;
    }
    
    .breadcrumb span {
      color: #b8860b;
      font-weight: 600;
    }
    
    /* Hero Section */
    .hero-section {
      background: linear-gradient(135deg, #002147 0%, #001633 100%);
      position: relative;
      overflow: hidden;
      padding: 80px 0;
    }
    
    .hero-section::before {
      content: '';
      position: absolute;
      top: -50%;
      right: -10%;
      width: 600px;
      height: 600px;
      background: radial-gradient(circle, rgba(184, 134, 11, 0.1) 0%, transparent 70%);
      border-radius: 50%;
      animation: float 20s ease-in-out infinite;
    }
    
    @keyframes float {
      0%, 100% { transform: translateY(0) rotate(0deg); }
      50% { transform: translateY(-30px) rotate(180deg); }
    }
    
    .hero-content {
      position: relative;
      z-index: 2;
      max-width: 1200px;
      margin: 0 auto;
      padding: 0 20px;
    }
    
    .hero-header {
      display: flex;
      justify-content: space-between;
      align-items: start;
      gap: 40px;
      flex-wrap: wrap;
    }
    
    .hero-info {
      flex: 1;
      min-width: 300px;
    }
    
    .course-code-badge {
      display: inline-block;
      padding: 8px 20px;
      background: rgba(184, 134, 11, 0.2);
      border: 1px solid rgba(184, 134, 11, 0.3);
      border-radius: 30px;
      color: #b8860b;
      font-size: 14px;
      font-weight: 600;
      margin-bottom: 20px;
      backdrop-filter: blur(10px);
    }
    
    .hero-title {
      font-family: 'Playfair Display', serif;
      font-size: 48px;
      font-weight: 700;
      color: white;
      margin-bottom: 20px;
      line-height: 1.2;
    }
    
    .hero-description {
      font-size: 18px;
      color: rgba(255, 255, 255, 0.9);
      line-height: 1.8;
      margin-bottom: 30px;
    }
    
    .hero-meta {
      display: flex;
      gap: 30px;
      flex-wrap: wrap;
    }
    
    .meta-item {
      display: flex;
      align-items: center;
      gap: 10px;
      color: rgba(255, 255, 255, 0.8);
      font-size: 15px;
    }
    
    .meta-item i {
      color: #b8860b;
      font-size: 18px;
    }
    
    .hero-actions {
      background: rgba(255, 255, 255, 0.1);
      backdrop-filter: blur(20px);
      border: 1px solid rgba(255, 255, 255, 0.2);
      border-radius: 15px;
      padding: 30px;
      min-width: 320px;
    }
    
    .price-display {
      text-align: center;
      margin-bottom: 25px;
    }
    
    .price-label {
      color: rgba(255, 255, 255, 0.7);
      font-size: 14px;
      text-transform: uppercase;
      letter-spacing: 1px;
      margin-bottom: 5px;
      display: block;
    }
    
    .price-amount {
      font-size: 42px;
      font-weight: 700;
      color: white;
      margin-bottom: 5px;
    }
    
    .price-currency {
      font-size: 24px;
      font-weight: 400;
    }
    
    .free-badge {
      background: #28a745;
      color: white;
      padding: 8px 20px;
      border-radius: 20px;
      font-size: 24px;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 1px;
    }
    
    .early-bird-tag {
      display: inline-block;
      background: #28a745;
      color: white;
      padding: 5px 15px;
      border-radius: 20px;
      font-size: 13px;
      font-weight: 600;
      margin-top: 10px;
    }
    
    .action-buttons {
      display: flex;
      flex-direction: column;
      gap: 15px;
    }
    
    .btn-primary {
      background: linear-gradient(135deg, #b8860b 0%, #9a7209 100%);
      color: white;
      padding: 15px 30px;
      border: none;
      border-radius: 50px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      text-align: center;
      position: relative;
      overflow: hidden;
      text-decoration: none;
      display: inline-block;
    }
    
    .btn-primary:hover {
      transform: translateY(-2px);
      box-shadow: 0 10px 25px rgba(184, 134, 11, 0.3);
    }
    
    .btn-primary:disabled {
      opacity: 0.6;
      cursor: not-allowed;
      transform: none;
    }
    
    .btn-secondary {
      background: transparent;
      color: white;
      padding: 15px 30px;
      border: 2px solid rgba(255, 255, 255, 0.3);
      border-radius: 50px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      text-align: center;
    }
    
    .btn-secondary:hover {
      background: rgba(255, 255, 255, 0.1);
      border-color: rgba(255, 255, 255, 0.5);
      transform: translateY(-2px);
    }
    
    .access-info {
      background: rgba(255, 255, 255, 0.05);
      border-radius: 10px;
      padding: 15px;
      margin-top: 20px;
      text-align: center;
    }
    
    .access-duration {
      color: rgba(255, 255, 255, 0.9);
      font-size: 14px;
      margin-bottom: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
    }
    
    .access-duration i {
      color: #b8860b;
    }
    
    /* Main Content */
    .main-content {
      max-width: 1200px;
      margin: -40px auto 60px;
      padding: 0 20px;
      position: relative;
      z-index: 10;
    }
    
    /* Quick Info Bar */
    .quick-info-bar {
      background: white;
      border-radius: 15px;
      padding: 30px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 30px;
      margin-bottom: 40px;
    }
    
    .info-item {
      text-align: center;
      padding: 20px;
      border-radius: 10px;
      background: #f8f9fa;
      transition: all 0.3s ease;
    }
    
    .info-item:hover {
      background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
      transform: translateY(-5px);
    }
    
    .info-icon {
      width: 50px;
      height: 50px;
      background: linear-gradient(135deg, #002147 0%, #003366 100%);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      margin: 0 auto 15px;
    }
    
    .info-icon i {
      color: white;
      font-size: 20px;
    }
    
    .info-label {
      font-size: 13px;
      color: #666;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      margin-bottom: 5px;
    }
    
    .info-value {
      font-size: 18px;
      font-weight: 600;
      color: #002147;
    }
    
    /* Content Sections */
    .content-section {
      background: white;
      border-radius: 15px;
      padding: 40px;
      margin-bottom: 30px;
      box-shadow: 0 5px 20px rgba(0, 0, 0, 0.08);
      position: relative;
      overflow: hidden;
    }
    
    .content-section::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 5px;
      height: 100%;
      background: linear-gradient(180deg, #b8860b 0%, #002147 100%);
    }
    
    .section-header {
      display: flex;
      align-items: center;
      gap: 15px;
      margin-bottom: 30px;
    }
    
    .section-icon {
      width: 40px;
      height: 40px;
      background: linear-gradient(135deg, #b8860b 0%, #9a7209 100%);
      border-radius: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    
    .section-icon i {
      color: white;
      font-size: 18px;
    }
    
    .section-title {
      font-family: 'Playfair Display', serif;
      font-size: 28px;
      font-weight: 700;
      color: #002147;
    }
    
    /* Course Overview */
    .overview-content {
      font-size: 16px;
      line-height: 1.8;
      color: #555;
    }
    
    .overview-content p {
      margin-bottom: 20px;
    }
    
    /* Learning Objectives */
    .objectives-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 20px;
    }
    
    .objective-item {
      display: flex;
      gap: 15px;
      padding: 20px;
      background: #f8f9fa;
      border-radius: 10px;
      transition: all 0.3s ease;
    }
    
    .objective-item:hover {
      background: #f0f7ff;
      transform: translateX(5px);
    }
    
    .objective-number {
      width: 40px;
      height: 40px;
      background: linear-gradient(135deg, #002147 0%, #003366 100%);
      color: white;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 700;
      flex-shrink: 0;
    }
    
    .objective-text {
      flex: 1;
      color: #333;
      line-height: 1.6;
    }
    
    /* Video Curriculum */
    .video-curriculum {
      position: relative;
    }
    
    .video-item {
      position: relative;
      margin-bottom: 20px;
      padding: 25px;
      background: #f8f9fa;
      border-radius: 10px;
      transition: all 0.3s ease;
      border-left: 4px solid #e0e0e0;
    }
    
    .video-item:hover {
      background: white;
      box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1);
      border-left-color: #b8860b;
    }
    
    .video-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 15px;
    }
    
    .video-number {
      display: flex;
      align-items: center;
      gap: 10px;
      font-weight: 600;
      color: #002147;
    }
    
    .video-number i {
      color: #b8860b;
    }
    
    .video-title {
      font-size: 18px;
      font-weight: 600;
      color: #002147;
      margin-bottom: 8px;
    }
    
    .video-duration {
      display: inline-flex;
      align-items: center;
      gap: 5px;
      padding: 5px 15px;
      background: white;
      border-radius: 20px;
      font-size: 13px;
      color: #666;
    }
    
    .video-description {
      color: #555;
      line-height: 1.6;
      margin-bottom: 15px;
    }
    
    .video-actions {
      display: flex;
      gap: 15px;
      align-items: center;
    }
    
    .watch-btn {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 10px 20px;
      background: linear-gradient(135deg, #b8860b 0%, #9a7209 100%);
      color: white;
      text-decoration: none;
      border-radius: 25px;
      font-size: 14px;
      font-weight: 600;
      transition: all 0.3s ease;
    }
    
    .watch-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 5px 15px rgba(184, 134, 11, 0.3);
    }
    
    .quiz-indicator {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 8px 16px;
      background: #e3f2fd;
      color: #1976d2;
      border-radius: 20px;
      font-size: 13px;
      font-weight: 500;
    }
    
    .locked-content {
      display: flex;
      flex-direction: column;
      align-items: center;
      text-align: center;
      padding: 40px;
      background: #f8f9fa;
      border-radius: 10px;
      border: 2px dashed #e0e0e0;
    }
    
    .locked-content i {
      font-size: 48px;
      color: #ccc;
      margin-bottom: 20px;
    }
    
    .locked-content h3 {
      color: #666;
      margin-bottom: 15px;
    }
    
    .locked-content p {
      color: #888;
      margin-bottom: 20px;
    }
    
    .preview-videos {
      margin-top: 20px;
    }
    
    .preview-video-item {
      display: flex;
      align-items: center;
      gap: 15px;
      padding: 15px;
      background: white;
      border-radius: 8px;
      margin-bottom: 10px;
      transition: all 0.3s ease;
    }
    
    .preview-video-item:hover {
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
    }
    
    .preview-play-btn {
      width: 40px;
      height: 40px;
      background: #b8860b;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      text-decoration: none;
      transition: all 0.3s ease;
    }
    
    .preview-play-btn:hover {
      background: #9a7209;
      transform: scale(1.1);
    }
    
    .preview-video-info {
      flex: 1;
    }
    
    .preview-video-title {
      font-weight: 600;
      color: #002147;
      margin-bottom: 5px;
    }
    
    .preview-video-duration {
      font-size: 13px;
      color: #666;
    }
    
    /* Certificate Features */
    .certification-features {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 25px;
      margin-top: 30px;
    }
    
    .cert-feature {
      text-align: center;
      padding: 25px;
      background: #f8f9fa;
      border-radius: 10px;
      transition: all 0.3s ease;
    }
    
    .cert-feature:hover {
      background: white;
      box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1);
      transform: translateY(-5px);
    }
    
    .cert-icon {
      width: 60px;
      height: 60px;
      background: linear-gradient(135deg, #b8860b 0%, #9a7209 100%);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      margin: 0 auto 15px;
    }
    
    .cert-icon i {
      color: white;
      font-size: 24px;
    }
    
    .cert-title {
      font-size: 16px;
      font-weight: 600;
      color: #002147;
      margin-bottom: 8px;
    }
    
    .cert-description {
      font-size: 14px;
      color: #666;
      line-height: 1.5;
    }
    
    /* Requirements Grid */
    .requirements-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 30px;
    }
    
    .requirement-card {
      background: #f8f9fa;
      border-radius: 10px;
      padding: 30px;
    }
    
    .requirement-card h4 {
      font-size: 18px;
      font-weight: 600;
      color: #002147;
      margin-bottom: 20px;
      display: flex;
      align-items: center;
      gap: 10px;
    }
    
    .requirement-card h4 i {
      color: #b8860b;
    }
    
    .requirement-list {
      list-style: none;
    }
    
    .requirement-list li {
      position: relative;
      padding-left: 25px;
      margin-bottom: 12px;
      color: #555;
      line-height: 1.6;
    }
    
    .requirement-list li::before {
      content: '\f00c';
      font-family: 'Font Awesome 6 Free';
      font-weight: 900;
      position: absolute;
      left: 0;
      top: 2px;
      color: #28a745;
    }
    
    /* Terms Box */
    .terms-box {
      background: #f8f9fa;
      border: 1px solid #e0e0e0;
      border-radius: 10px;
      padding: 25px;
      margin-top: 20px;
    }
    
    .terms-title {
      font-size: 16px;
      font-weight: 600;
      color: #002147;
      margin-bottom: 15px;
      display: flex;
      align-items: center;
      gap: 10px;
    }
    
    .terms-title i {
      color: #b8860b;
    }
    
    .terms-list {
      list-style: none;
    }
    
    .terms-list li {
      position: relative;
      padding-left: 25px;
      margin-bottom: 10px;
      font-size: 14px;
      color: #555;
      line-height: 1.6;
    }
    
    .terms-list li::before {
      content: '\f054';
      font-family: 'Font Awesome 6 Free';
      font-weight: 900;
      position: absolute;
      left: 0;
      top: 2px;
      color: #b8860b;
      font-size: 12px;
    }
    
    /* FAQ Section */
    .faq-accordion {
      margin-top: 20px;
    }
    
    .faq-item {
      background: white;
      border: 1px solid #e0e0e0;
      border-radius: 10px;
      margin-bottom: 15px;
      overflow: hidden;
      transition: all 0.3s ease;
    }
    
    .faq-item:hover {
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
    }
    
    .faq-question {
      padding: 20px 25px;
      background: #f8f9fa;
      cursor: pointer;
      display: flex;
      justify-content: space-between;
      align-items: center;
      transition: all 0.3s ease;
    }
    
    .faq-question:hover {
      background: #f0f0f0;
    }
    
    .faq-question h4 {
      font-size: 16px;
      font-weight: 600;
      color: #002147;
      margin: 0;
    }
    
    .faq-icon {
      font-size: 20px;
      color: #b8860b;
      transition: transform 0.3s ease;
    }
    
    .faq-item.active .faq-icon {
      transform: rotate(180deg);
    }
    
    .faq-answer {
      padding: 0 25px;
      max-height: 0;
      overflow: hidden;
      transition: all 0.3s ease;
    }
    
    .faq-item.active .faq-answer {
      padding: 20px 25px;
      max-height: 500px;
    }
    
    .faq-answer p {
      color: #555;
      line-height: 1.6;
    }
    
    /* Mobile Action Bar */
    .mobile-action-bar {
      display: none;
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      background: white;
      padding: 15px 20px;
      box-shadow: 0 -5px 20px rgba(0, 0, 0, 0.1);
      z-index: 100;
    }
    
    .mobile-action-content {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 15px;
    }
    
    .mobile-price {
      font-size: 24px;
      font-weight: 700;
      color: #002147;
    }
    
    .mobile-buttons {
      display: flex;
      gap: 10px;
    }
    
    /* Notification */
    .notification {
      position: fixed;
      top: 20px;
      right: -400px;
      max-width: 400px;
      padding: 20px 25px;
      background: white;
      border-radius: 10px;
      box-shadow: 0 10px 40px rgba(0, 0, 0, 0.15);
      display: flex;
      align-items: center;
      gap: 15px;
      transition: right 0.5s cubic-bezier(0.68, -0.55, 0.265, 1.55);
      z-index: 1000;
    }
    
    .notification.show {
      right: 20px;
    }
    
    .notification-icon {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      flex-shrink: 0;
    }
    
    .notification.success .notification-icon {
      background: #d4f4dd;
      color: #2e7d3e;
    }
    
    .notification.error .notification-icon {
      background: #f8d7da;
      color: #721c24;
    }
    
    .notification.warning .notification-icon {
      background: #fff3cd;
      color: #856404;
    }
    
    .notification-content h4 {
      margin: 0 0 5px;
      font-size: 16px;
      font-weight: 600;
    }
    
    .notification-content p {
      margin: 0;
      font-size: 14px;
      color: #666;
    }
    
    /* Loading State */
    .btn-loading {
      pointer-events: none;
      opacity: 0.7;
    }
    
    .btn-loading i {
      animation: spin 1s linear infinite;
    }
    
    @keyframes spin {
      from { transform: rotate(0deg); }
      to { transform: rotate(360deg); }
    }
    
    /* Responsive */
    @media (max-width: 768px) {
      .hero-header {
        flex-direction: column;
      }
      
      .hero-title {
        font-size: 32px;
      }
      
      .hero-actions {
        margin-top: 20px;
      }
      
      .quick-info-bar {
        grid-template-columns: repeat(2, 1fr);
        gap: 15px;
        padding: 20px;
      }
      
      .content-section {
        padding: 25px 20px;
      }
      
      .section-title {
        font-size: 24px;
      }
      
      .objectives-grid {
        grid-template-columns: 1fr;
      }
      
      .mobile-action-bar {
        display: block;
      }
      
      .main-content {
        margin-bottom: 100px;
      }
      
      .notification {
        left: 10px;
        right: 10px;
        max-width: none;
      }
      
      .notification.show {
        right: 10px;
      }
    }
  
  /* ADD these simple preview video styles to your existing CSS */

/* Preview Videos Grid */
.preview-videos-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
  gap: 20px;
  margin-bottom: 20px;
}

/* Preview Video Card */
.preview-video-card {
  background: white;
  border-radius: 12px;
  overflow: hidden;
  box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
  transition: all 0.3s ease;
  border: 2px solid #e0e7ff;
}

.preview-video-card:hover {
  transform: translateY(-5px);
  box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
  border-color: #b8860b;
}

/* Preview Thumbnail */
.preview-thumbnail {
  position: relative;
  height: 180px;
  background: linear-gradient(135deg, #002147 0%, #003366 100%);
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  overflow: hidden;
}

.preview-play-overlay {
  width: 60px;
  height: 60px;
  background: rgba(184, 134, 11, 0.9);
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  color: white;
  font-size: 24px;
  transition: all 0.3s ease;
  backdrop-filter: blur(10px);
}

.preview-thumbnail:hover .preview-play-overlay {
  background: #b8860b;
  transform: scale(1.1);
}

.preview-duration {
  position: absolute;
  bottom: 10px;
  right: 10px;
  background: rgba(0, 0, 0, 0.7);
  color: white;
  padding: 4px 8px;
  border-radius: 4px;
  font-size: 12px;
  display: flex;
  align-items: center;
  gap: 4px;
}

.preview-badge {
  position: absolute;
  top: 10px;
  left: 10px;
  background: #28a745;
  color: white;
  padding: 4px 12px;
  border-radius: 15px;
  font-size: 11px;
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

/* Preview Content */
.preview-content {
  padding: 20px;
}

.preview-title {
  font-size: 16px;
  font-weight: 600;
  color: #002147;
  margin-bottom: 8px;
  line-height: 1.3;
}

.preview-description {
  color: #666;
  font-size: 14px;
  line-height: 1.5;
  margin-bottom: 15px;
}

.preview-watch-btn {
  width: 100%;
  padding: 10px 20px;
  background: linear-gradient(135deg, #b8860b 0%, #9a7209 100%);
  color: white;
  border: none;
  border-radius: 25px;
  font-size: 14px;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.3s ease;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 8px;
}

.preview-watch-btn:hover {
  transform: translateY(-2px);
  box-shadow: 0 5px 15px rgba(184, 134, 11, 0.3);
}

/* Preview Call-to-Action */
.preview-cta {
  animation: subtle-pulse 3s ease-in-out infinite;
}

@keyframes subtle-pulse {
  0%, 100% { transform: scale(1); }
  50% { transform: scale(1.02); }
}

/* Mobile Responsiveness */
@media (max-width: 768px) {
  .preview-videos-grid {
    grid-template-columns: 1fr;
    gap: 15px;
  }
  
  .preview-thumbnail {
    height: 160px;
  }
  
  .preview-content {
    padding: 15px;
  }
}

/* ADD these instructor styles to your existing CSS */

/* Instructor Profile Section */
.instructor-profile {
  background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
  border-radius: 15px;
  padding: 2rem;
  margin-top: 1rem;
}

.instructor-main-info {
  display: flex;
  gap: 2rem;
  align-items: flex-start;
}

.instructor-photo-section {
  flex-shrink: 0;
  text-align: center;
}

.instructor-photo {
  width: 150px;
  height: 150px;
  border-radius: 50%;
  object-fit: cover;
  border: 4px solid #b8860b;
  box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
  transition: all 0.3s ease;
}

.instructor-photo:hover {
  transform: scale(1.05);
  box-shadow: 0 12px 35px rgba(0, 0, 0, 0.2);
}

.instructor-photo-placeholder {
  width: 150px;
  height: 150px;
  border-radius: 50%;
  background: linear-gradient(135deg, #002147 0%, #003366 100%);
  display: flex;
  align-items: center;
  justify-content: center;
  border: 4px solid #b8860b;
  position: relative;
  overflow: hidden;
}

.instructor-photo-placeholder .fa-user {
  font-size: 4rem;
  color: rgba(255, 255, 255, 0.3);
}

.instructor-initials {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  font-size: 2.5rem;
  font-weight: bold;
  color: white;
  z-index: 2;
}

.instructor-rating {
  margin-top: 1rem;
}

.rating-stars {
  display: flex;
  justify-content: center;
  gap: 0.25rem;
  margin-bottom: 0.5rem;
}

.rating-stars i {
  color: #ffc107;
  font-size: 1.2rem;
}

.rating-text {
  font-size: 0.875rem;
  color: #666;
  font-weight: 600;
}

.instructor-details {
  flex: 1;
}

.instructor-name {
  font-size: 2rem;
  font-weight: 700;
  color: #002147;
  margin-bottom: 0.5rem;
  font-family: 'Playfair Display', serif;
}

.instructor-title {
  font-size: 1.125rem;
  color: #b8860b;
  font-weight: 600;
  margin-bottom: 1rem;
}

.instructor-bio {
  font-size: 1rem;
  line-height: 1.6;
  color: #555;
  margin-bottom: 1.5rem;
}

.instructor-expertise,
.instructor-qualifications {
  margin-bottom: 1.5rem;
}

.instructor-expertise h4,
.instructor-qualifications h4 {
  font-size: 1.125rem;
  font-weight: 600;
  color: #002147;
  margin-bottom: 1rem;
  display: flex;
  align-items: center;
  gap: 0.5rem;
}

.instructor-expertise i,
.instructor-qualifications i {
  color: #b8860b;
}

.expertise-tags {
  display: flex;
  flex-wrap: wrap;
  gap: 0.5rem;
}

.expertise-tag {
  background: #b8860b;
  color: white;
  padding: 0.5rem 1rem;
  border-radius: 20px;
  font-size: 0.875rem;
  font-weight: 500;
}

.qualification-list {
  list-style: none;
  padding: 0;
}

.qualification-list li {
  position: relative;
  padding-left: 1.5rem;
  margin-bottom: 0.5rem;
  color: #555;
  line-height: 1.6;
}

.qualification-list li::before {
  content: '\f00c';
  font-family: 'Font Awesome 6 Free';
  font-weight: 900;
  position: absolute;
  left: 0;
  top: 0;
  color: #28a745;
}

/* Mobile Responsiveness */
@media (max-width: 768px) {
  .instructor-main-info {
    flex-direction: column;
    text-align: center;
    gap: 1.5rem;
  }
  
  .instructor-photo,
  .instructor-photo-placeholder {
    width: 120px;
    height: 120px;
  }
  
  .instructor-name {
    font-size: 1.5rem;
  }
  
  .instructor-profile {
    padding: 1.5rem;
  }
  
  .expertise-tags {
    justify-content: center;
  }
}

/* ADD these minimal styles for instructor photo */

.instructor-card-with-photo {
  display: flex !important;
  gap: 1.5rem;
  align-items: flex-start;
}

.instructor-photo-section {
  flex-shrink: 0;
}

.instructor-profile-image {
  width: 80px;
  height: 80px;
  border-radius: 50%;
  object-fit: cover;
  border: 3px solid #b8860b;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
}

.instructor-photo-placeholder {
  width: 80px;
  height: 80px;
  border-radius: 50%;
  background: linear-gradient(135deg, #002147 0%, #b8860b 100%);
  display: flex;
  align-items: center;
  justify-content: center;
  border: 3px solid #b8860b;
}

.instructor-initials {
  font-size: 1.5rem;
  font-weight: bold;
  color: white;
}

.instructor-text-content {
  flex: 1;
}

/* Mobile responsiveness */
@media (max-width: 768px) {
  .instructor-card-with-photo {
    flex-direction: column !important;
    align-items: center;
    text-align: center;
  }
  
  .instructor-photo-section {
    margin-bottom: 1rem;
  }
}
</style>
</head>

<body>
  <%- include('partials/header') %>

  <!-- Enhanced Breadcrumb -->
  <nav class="breadcrumb">
    <a href="/"><i class="fas fa-home"></i> Home</a> 
    <i class="fas fa-chevron-right" style="margin: 0 10px; color: #999; font-size: 12px;"></i>
    <a href="/training-programs">Training Programs</a> 
    <i class="fas fa-chevron-right" style="margin: 0 10px; color: #999; font-size: 12px;"></i>
    <a href="/self-paced-online-training">Self-Paced Online Training</a>
    <i class="fas fa-chevron-right" style="margin: 0 10px; color: #999; font-size: 12px;"></i>
    <span><%= course.basic?.title || course.title || 'Course Details' %></span>
  </nav>

  <!-- Hero Section -->
  <section class="hero-section">
    <div class="hero-content">
      <div class="hero-header">
        <div class="hero-info">
          <div class="course-code-badge">
            <i class="fas fa-tag"></i> <%= course.basic?.courseCode || course.courseCode || 'N/A' %>
          </div>
          <h1 class="hero-title"><%= course.basic?.title || course.title || 'Self-Paced Online Training Course' %></h1>
          <p class="hero-description"><%= course.basic?.description || course.description || 'Master new skills at your own pace with our comprehensive video-based training program.' %></p>
          
          <div class="hero-meta">
            <div class="meta-item">
              <i class="fas fa-user-md"></i>
              <span><%= course.instructor?.name || course.instructor || 'Expert Instructors' %></span>
            </div>
            <div class="meta-item">
              <i class="fas fa-play-circle"></i>
              <span><%= course.videos?.length || course.content?.totalVideos || 0 %> Video Lessons</span>
            </div>
            <div class="meta-item">
              <i class="fas fa-clock"></i>
              <span>
                <%= course.content?.estimatedMinutes ? Math.round(course.content.estimatedMinutes / 60 * 10) / 10 + ' hours' : 
                    course.totalHours ? course.totalHours + ' hours' : 'Self-paced' %>
              </span>
            </div>
            <div class="meta-item">
              <i class="fas fa-graduation-cap"></i>
              <span><%= course.content?.experienceLevel || course.level || 'All Levels' %></span>
            </div>
          </div>
        </div>
        
        <div class="hero-actions">
          <div class="price-display">
            <span class="price-label">Course Price</span>
            <% if ((course.access?.price || course.price || 0) === 0) { %>
              <div class="free-badge">FREE</div>
            <% } else { %>
              <div class="price-amount">
                <span class="price-currency">$</span><%= course.access?.price || course.price || 0 %>
              </div>
              <% if (course.earlyBirdPrice) { %>
                <span class="early-bird-tag">
                  <i class="fas fa-tag"></i> Special Offer: $<%= course.earlyBirdPrice %>
                </span>
              <% } %>
            <% } %>
          </div>
          
          <div class="action-buttons">
            <% if (user) { %>
              <% if (user.mySelfPacedCourses && user.mySelfPacedCourses.some(c => c.courseId.toString() === course._id.toString() && (c.status === 'Paid and Registered' || c.status === 'Registered (promo code)'))) { %>
                <!-- User already registered -->
                <a href="/library" class="btn-primary">
                  <i class="fas fa-book"></i> Go to My Library
                </a>
              <% } else { %>
                <!-- Add to Cart/Wishlist -->
                <button class="btn-primary add-to-cart-btn" 
                        data-course-id="<%= course._id %>" 
                        data-course-type="SelfPacedOnlineTraining"
                        data-price="<%= course.access?.price || course.price || 0 %>"
                        data-course-code="<%= course.basic?.courseCode || course.courseCode || 'N/A' %>"
                        data-course-title="<%= course.basic?.title || course.title || 'Untitled Course' %>"
                        <%= (course.basic?.status !== 'published' && course.status !== 'published') ? 'disabled' : '' %>>
                  <i class="fas fa-shopping-cart"></i> 
                  <%= ((course.access?.price || course.price || 0) === 0) ? 'Enroll for Free' : 'Add to Cart' %>
                </button>
                
                <button class="btn-secondary add-to-wishlist-btn" 
                        data-course-id="<%= course._id %>" 
                        data-course-type="SelfPacedOnlineTraining"
                        data-price="<%= course.access?.price || course.price || 0 %>"
                        data-course-code="<%= course.basic?.courseCode || course.courseCode || 'N/A' %>"
                        data-course-title="<%= course.basic?.title || course.title || 'Untitled Course' %>">
                  <i class="fas fa-heart"></i> Save to Wishlist
                </button>
              <% } %>
            <% } else { %>
              <button class="btn-primary" onclick="showLoginRequired()">
                <i class="fas fa-shopping-cart"></i> 
                <%= ((course.access?.price || course.price || 0) === 0) ? 'Enroll for Free' : 'Add to Cart' %>
              </button>
              <button class="btn-secondary" onclick="showLoginRequired()">
                <i class="fas fa-heart"></i> Save to Wishlist
              </button>
            <% } %>
          </div>
          
          <div class="access-info">
            <div class="access-duration">
              <i class="fas fa-infinity"></i>
              <span>
                <%= course.access?.accessDays ? 
                    (course.access.accessDays === 0 ? 'Lifetime Access' : course.access.accessDays + ' Days Access') : 
                    'Lifetime Access' %>
              </span>
            </div>
            <div style="font-size: 12px; color: rgba(255, 255, 255, 0.7);">
              <i class="fas fa-mobile-alt"></i> Access on any device
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Main Content -->
  <div class="main-content">
    <!-- Quick Info Bar -->
    <div class="quick-info-bar">
      <div class="info-item">
        <div class="info-icon">
          <i class="fas fa-play-circle"></i>
        </div>
        <div class="info-label">Video Lessons</div>
        <div class="info-value"><%= course.videos?.length || course.content?.totalVideos || 0 %></div>
      </div>
      
      <div class="info-item">
        <div class="info-icon">
          <i class="fas fa-clock"></i>
        </div>
        <div class="info-label">Duration</div>
        <div class="info-value">
          <%= course.content?.estimatedMinutes ? Math.round(course.content.estimatedMinutes / 60 * 10) / 10 + 'h' : 
              course.totalHours ? course.totalHours + 'h' : 'Self-paced' %>
        </div>
      </div>
      
      <div class="info-item">
        <div class="info-icon">
          <i class="fas fa-certificate"></i>
        </div>
        <div class="info-label">Certificate</div>
        <div class="info-value">
          <%= course.certification?.enabled !== false ? 'Yes' : 
              course.certificateProvided !== false ? 'Yes' : 'Yes' %>
        </div>
      </div>
      
      <div class="info-item">
        <div class="info-icon">
          <i class="fas fa-graduation-cap"></i>
        </div>
        <div class="info-label">Level</div>
        <div class="info-value">
          <%= course.content?.experienceLevel || course.level || 'All Levels' %>
        </div>
      </div>
      
      <div class="info-item">
        <div class="info-icon">
          <i class="fas fa-language"></i>
        </div>
        <div class="info-label">Language</div>
        <div class="info-value">English</div>
      </div>
      
      <div class="info-item">
        <div class="info-icon">
          <i class="fas fa-infinity"></i>
        </div>
        <div class="info-label">Access</div>
        <div class="info-value">Lifetime</div>
      </div>
    </div>

  
    

    <!-- Learning Objectives -->
    <% if ((course.content?.objectives && course.content.objectives.length > 0) || (course.objectives && course.objectives.length > 0)) { %>
    <div class="content-section">
      <div class="section-header">
        <div class="section-icon">
          <i class="fas fa-bullseye"></i>
        </div>
        <h2 class="section-title">Learning Objectives</h2>
      </div>
      
      <div class="objectives-grid">
        <% const objectives = course.content?.objectives || course.objectives || []; %>
        <% objectives.forEach((objective, index) => { %>
        <div class="objective-item">
          <div class="objective-number"><%= index + 1 %></div>
          <div class="objective-text"><%= objective %></div>
        </div>
        <% }) %>
      </div>
    </div>
    <% } %>

    <!-- Course Content/Videos -->
    <div class="content-section">
      <div class="section-header">
        <div class="section-icon">
          <i class="fas fa-play-circle"></i>
        </div>
        <h2 class="section-title">Course Content</h2>
      </div>
      
      <% if (user && user.mySelfPacedCourses && user.mySelfPacedCourses.some(c => c.courseId.toString() === course._id.toString() && (c.status === 'Paid and Registered' || c.status === 'Registered (promo code)'))) { %>
        <!-- Show full content for enrolled users -->
        <div class="video-curriculum">
          <% if (course.videos && course.videos.length > 0) { %>
            <% course.videos.forEach((video, index) => { %>
            <div class="video-item">
              <div class="video-header">
                <div class="video-number">
                  <i class="fas fa-play-circle"></i>
                  Video <%= index + 1 %>
                </div>
                <% if (video.duration) { %>
                <span class="video-duration">
                  <i class="far fa-clock"></i> <%= video.duration %>
                </span>
                <% } %>
              </div>
              
              <h3 class="video-title"><%= video.title %></h3>
              <% if (video.description) { %>
              <p class="video-description"><%= video.description %></p>
              <% } %>
              
              <div class="video-actions">
                <% if (video.videoUrl || video.url) { %>
                <a href="<%= video.videoUrl || video.url %>" target="_blank" class="watch-btn">
                  <i class="fas fa-play"></i> Watch Video
                </a>
                <% } %>
                <% if (video.exam && video.exam.length > 0) { %>
                <span class="quiz-indicator">
                  <i class="fas fa-question-circle"></i> 
                  Quiz Available (<%= video.exam.length %> questions)
                </span>
                <% } %>
              </div>
            </div>
            <% }) %>
          <% } else { %>
            <div class="video-item">
              <div class="video-header">
                <div class="video-number">
                  <i class="fas fa-play-circle"></i>
                  Course Content
                </div>
              </div>
              <h3 class="video-title">Access Your Learning Materials</h3>
              <p class="video-description">Your course content is being prepared. Please check back soon or contact support for assistance.</p>
              <div class="video-actions">
                <a href="/library" class="watch-btn">
                  <i class="fas fa-book"></i> Go to Library
                </a>
              </div>
            </div>
          <% } %>
        </div>
      <% } else { %>
        <!-- Show preview for non-enrolled users -->
        
        <!-- Preview Videos Section -->
        <% if (course.videos && course.videos.some(v => v.isPreview)) { %>
        <div class="preview-section" style="margin-bottom: 30px;">
          <h3 style="color: #002147; margin-bottom: 20px; display: flex; align-items: center; gap: 10px;">
            <i class="fas fa-eye" style="color: #b8860b;"></i>
            Free Preview - See What You'll Learn
          </h3>
          
          <div class="preview-videos-grid">
            <% course.videos.filter(v => v.isPreview).forEach((video, index) => { %>
            <div class="preview-video-card">
              <div class="preview-thumbnail" onclick="playPreviewVideo('<%= video.videoUrl %>', '<%= video.title %>')">
                <div class="preview-play-overlay">
                  <i class="fas fa-play"></i>
                </div>
                <div class="preview-duration">
                  <% if (video.duration) { %>
                    <i class="fas fa-clock"></i> <%= video.duration %> min
                  <% } %>
                </div>
                <div class="preview-badge">FREE PREVIEW</div>
              </div>
              
              <div class="preview-content">
                <h4 class="preview-title"><%= video.title %></h4>
                <p class="preview-description"><%= video.description || 'Get a taste of what this course offers' %></p>
                
  
              </div>
            </div>
            <% }) %>
          </div>
          
          <div class="preview-cta" style="text-align: center; margin-top: 25px; padding: 20px; background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%); border-radius: 10px;">
            <p style="color: #666; margin-bottom: 15px;">
              <strong>This is just the beginning!</strong> Unlock <%= course.videos.length - course.videos.filter(v => v.isPreview).length %> more videos with full course access.
            </p>
            <button class="btn-primary" onclick="scrollToEnrollment()" style="display: inline-block; padding: 12px 30px; text-decoration: none;">
              <i class="fas fa-unlock"></i> Unlock Full Course
            </button>
          </div>
        </div>
        <% } %>
      
      <% } %>
    </div>

    <!-- Course Features -->
    <div class="content-section">
      <div class="section-header">
        <div class="section-icon">
          <i class="fas fa-star"></i>
        </div>
        <h2 class="section-title">Course Features</h2>
      </div>
      
      <div class="certification-features">
        <div class="cert-feature">
          <div class="cert-icon">
            <i class="fas fa-infinity"></i>
          </div>
          <h4 class="cert-title">Lifetime Access</h4>
          <p class="cert-description">Learn at your own pace with unlimited access to all course materials</p>
        </div>
        
        <div class="cert-feature">
          <div class="cert-icon">
            <i class="fas fa-mobile-alt"></i>
          </div>
          <h4 class="cert-title">Mobile Learning</h4>
          <p class="cert-description">Access your courses on any device - desktop, tablet, or mobile</p>
        </div>
        
        <div class="cert-feature">
          <div class="cert-icon">
            <i class="fas fa-certificate"></i>
          </div>
          <h4 class="cert-title">Certificate of Completion</h4>
          <p class="cert-description">Earn a professional certificate upon successful course completion</p>
        </div>
        
        <div class="cert-feature">
          <div class="cert-icon">
            <i class="fas fa-headset"></i>
          </div>
          <h4 class="cert-title">Expert Support</h4>
          <p class="cert-description">Get help when you need it from our experienced instructors</p>
        </div>
        
        <div class="cert-feature">
          <div class="cert-icon">
            <i class="fas fa-download"></i>
          </div>
          <h4 class="cert-title">Downloadable Resources</h4>
          <p class="cert-description">Access supplementary materials and resources for offline learning</p>
        </div>
        
        <div class="cert-feature">
          <div class="cert-icon">
            <i class="fas fa-clock"></i>
          </div>
          <h4 class="cert-title">Self-Paced Learning</h4>
          <p class="cert-description">Study at your own speed and schedule that works for you</p>
        </div>
      </div>
    </div>

    <!-- Instructor Information -->
<!-- Enhanced Instructor Information with Photo -->
<% if (course.instructor?.name || course.instructor) { %>
  <div class="content-section">
    <div class="section-header">
      <div class="section-icon">
        <i class="fas fa-user-md"></i>
      </div>
      <h2 class="section-title">Your Instructor</h2>
    </div>
    
    <div class="requirements-grid">
      <div class="requirement-card instructor-card-with-photo">
        <!-- NEW: Instructor Photo Section -->
        <div class="instructor-photo-section">
          <%
            // Try to get instructor data for photo
            let instructorData = course.instructor?.instructorId || course.instructor?.instructorData;
            let instructorPhoto = instructorData?.profileImage;
            let instructorName = course.instructor.name || course.instructor;
          %>
          
          <% if (instructorPhoto) { %>
            <img src="<%= instructorPhoto %>" 
                 alt="<%= instructorName %>"
                 class="instructor-profile-image"
                 onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';">
          <% } %>
          
          <!-- Fallback placeholder -->
          <div class="instructor-photo-placeholder" style="<%= instructorPhoto ? 'display: none;' : '' %>">
            <span class="instructor-initials">
              <%= instructorName.toString().split(' ').map(n => n.charAt(0)).join('').substring(0,2).toUpperCase() %>
            </span>
          </div>
        </div>
        
        <!-- Original Content -->
        <div class="instructor-text-content">
          <h4><i class="fas fa-user"></i> <%= course.instructor.name || course.instructor %></h4>
          <% if (course.instructor.title) { %>
          <p style="color: #666; margin-bottom: 15px;"><%= course.instructor.title %></p>
          <% } %>
          <p>Experienced professional with extensive expertise in aesthetic medicine and training. Dedicated to providing high-quality education and practical skills development.</p>
        </div>
      </div>
      
      <div class="requirement-card">
        <h4><i class="fas fa-award"></i> Expertise</h4>
        <ul class="requirement-list">
          <li>Advanced aesthetic medicine techniques</li>
          <li>Professional training and development</li>
          <li>Clinical practice and patient care</li>
          <li>Industry standards and best practices</li>
        </ul>
      </div>
    </div>
  </div>
  <% } %>

    <!-- Requirements & System Specs -->
    <div class="content-section">
      <div class="section-header">
        <div class="section-icon">
          <i class="fas fa-clipboard-list"></i>
        </div>
        <h2 class="section-title">Requirements</h2>
      </div>
      
      <div class="requirements-grid">
        <div class="requirement-card">
          <h4><i class="fas fa-check-circle"></i> Prerequisites</h4>
          <p><%= course.content?.prerequisites || course.prerequisites || 'No prior experience required. Basic understanding of medical or aesthetic concepts is helpful but not mandatory.' %></p>
        </div>
        
        <div class="requirement-card">
          <h4><i class="fas fa-laptop"></i> Technical Requirements</h4>
          <ul class="requirement-list">
            <li>Reliable internet connection</li>
            <li>Modern web browser (Chrome, Firefox, Safari, Edge)</li>
            <li>Device with video playback capability</li>
            <li>Speakers or headphones for audio</li>
          </ul>
        </div>
        
        <div class="requirement-card">
          <h4><i class="fas fa-tools"></i> What You'll Need</h4>
          <ul class="requirement-list">
            <li>Notebook for taking notes</li>
            <li>Quiet learning environment</li>
            <li>Commitment to complete the course</li>
            <li>Willingness to practice learned concepts</li>
          </ul>
        </div>
        
        <div class="requirement-card">
          <h4><i class="fas fa-gift"></i> What's Included</h4>
          <ul class="requirement-list">
            <li>All video lessons and materials</li>
            <li>Downloadable resources</li>
            <li>Course completion certificate</li>
            <li>Lifetime access to updates</li>
          </ul>
        </div>
      </div>
    </div>

    <!-- Certification Information -->
    <div class="content-section">
      <div class="section-header">
        <div class="section-icon">
          <i class="fas fa-certificate"></i>
        </div>
        <h2 class="section-title">Certification</h2>
      </div>
      
      <div class="certification-features">
        <div class="cert-feature">
          <div class="cert-icon">
            <i class="fas fa-award"></i>
          </div>
          <h4 class="cert-title">Certificate Type</h4>
          <p class="cert-description">
            <%= course.certification?.certificateTitle || 'Certificate of Completion' %>
          </p>
        </div>
        
        <div class="cert-feature">
          <div class="cert-icon">
            <i class="fas fa-tasks"></i>
          </div>
          <h4 class="cert-title">Requirements</h4>
          <p class="cert-description">
            <%= course.certification?.requireAllVideos !== false ? 'Complete all video lessons' : 'Complete course requirements' %>
            <%= course.certification?.minimumScore ? ` and achieve ${course.certification.minimumScore}% on assessments` : '' %>
          </p>
        </div>
        
        <div class="cert-feature">
          <div class="cert-icon">
            <i class="fas fa-shield-alt"></i>
          </div>
          <h4 class="cert-title">Verification</h4>
          <p class="cert-description">
            Digital certificate with unique verification code
          </p>
        </div>
        
        <div class="cert-feature">
          <div class="cert-icon">
            <i class="fas fa-building"></i>
          </div>
          <h4 class="cert-title">Issuing Authority</h4>
          <p class="cert-description">
            <%= course.certification?.issuingAuthority || 'IAAI Training Institute' %>
          </p>
        </div>
      </div>
    </div>

    <!-- FAQ Section -->
    <div class="content-section">
      <div class="section-header">
        <div class="section-icon">
          <i class="fas fa-question-circle"></i>
        </div>
        <h2 class="section-title">Frequently Asked Questions</h2>
      </div>
      
      <div class="faq-accordion">
        <div class="faq-item">
          <div class="faq-question" onclick="toggleFaq(this)">
            <h4>How long do I have access to the course?</h4>
            <i class="fas fa-chevron-down faq-icon"></i>
          </div>
          <div class="faq-answer">
            <p>You have lifetime access to this course. Once enrolled, you can access all materials anytime, anywhere, and revisit content as often as you'd like.</p>
          </div>
        </div>
        
        <div class="faq-item">
          <div class="faq-question" onclick="toggleFaq(this)">
            <h4>Can I download the videos for offline viewing?</h4>
            <i class="fas fa-chevron-down faq-icon"></i>
          </div>
          <div class="faq-answer">
            <p>While videos are not downloadable for copyright protection, you can access them anytime with an internet connection. We also provide downloadable resources and materials to support your learning.</p>
          </div>
        </div>
        
        <div class="faq-item">
          <div class="faq-question" onclick="toggleFaq(this)">
            <h4>Is there a certificate provided upon completion?</h4>
            <i class="fas fa-chevron-down faq-icon"></i>
          </div>
          <div class="faq-answer">
            <p>Yes! Upon successful completion of all course requirements, you'll receive a digital certificate of completion that you can download and share on professional networks.</p>
          </div>
        </div>
        
        <div class="faq-item">
          <div class="faq-question" onclick="toggleFaq(this)">
            <h4>What if I need help or have questions during the course?</h4>
            <i class="fas fa-chevron-down faq-icon"></i>
          </div>
          <div class="faq-answer">
            <p>Our support team is available to help with technical issues, and you can reach out to instructors for course-related questions. We typically respond within 24-48 hours.</p>
          </div>
        </div>
        
        <div class="faq-item">
          <div class="faq-question" onclick="toggleFaq(this)">
            <h4>Can I get a refund if I'm not satisfied?</h4>
            <i class="fas fa-chevron-down faq-icon"></i>
          </div>
          <div class="faq-answer">
            <p>We offer a 30-day money-back guarantee. If you're not completely satisfied with the course, contact us within 30 days of purchase for a full refund.</p>
          </div>
        </div>
      </div>
    </div>

    <!-- Contact Section -->
    <div class="content-section">
      <div class="section-header">
        <div class="section-icon">
          <i class="fas fa-envelope"></i>
        </div>
        <h2 class="section-title">Need More Information?</h2>
      </div>
      
      <div style="text-align: center; padding: 20px;">
        <p style="font-size: 16px; color: #555; margin-bottom: 20px;">
          Have questions about this course? Our learning advisors are here to help you make the right decision for your professional development.
        </p>
        <a href="/contact" class="btn-primary" style="display: inline-block; text-decoration: none;">
          <i class="fas fa-phone"></i> Contact Learning Advisor
        </a>
      </div>
    </div>
  </div>

  <!-- Mobile Action Bar -->
  <div class="mobile-action-bar">
    <div class="mobile-action-content">
      <div class="mobile-price">
        <% if ((course.access?.price || course.price || 0) === 0) { %>
          FREE
        <% } else { %>
          $<%= course.access?.price || course.price || 0 %>
        <% } %>
      </div>
      <div class="mobile-buttons">
        <% if (user) { %>
          <% if (user.mySelfPacedCourses && user.mySelfPacedCourses.some(c => c.courseId.toString() === course._id.toString() && (c.status === 'Paid and Registered' || c.status === 'Registered (promo code)'))) { %>
            <a href="/library" class="btn-primary" style="padding: 12px 20px; font-size: 14px; text-decoration: none;">
              <i class="fas fa-book"></i> Go to Library
            </a>
          <% } else { %>
            <button class="btn-primary add-to-cart-btn" 
                    data-course-id="<%= course._id %>" 
                    data-course-type="SelfPacedOnlineTraining"
                    data-price="<%= course.access?.price || course.price || 0 %>"
                    data-course-code="<%= course.basic?.courseCode || course.courseCode || 'N/A' %>"
                    data-course-title="<%= course.basic?.title || course.title || 'Untitled Course' %>"
                    style="padding: 12px 20px; font-size: 14px;">
              <i class="fas fa-shopping-cart"></i> 
              <%= ((course.access?.price || course.price || 0) === 0) ? 'Enroll Free' : 'Add to Cart' %>
            </button>
          <% } %>
        <% } else { %>
          <button class="btn-primary" onclick="showLoginRequired()" style="padding: 12px 20px; font-size: 14px;">
            <i class="fas fa-shopping-cart"></i> 
            <%= ((course.access?.price || course.price || 0) === 0) ? 'Enroll Free' : 'Add to Cart' %>
          </button>
        <% } %>
      </div>
    </div>
  </div>

  <!-- Notification Container -->
  <div id="notificationContainer"></div>

  <script>
    // Show notification function
    function showNotification(title, message, type = 'success') {
      const container = document.getElementById('notificationContainer');
      const notification = document.createElement('div');
      notification.className = `notification ${type}`;
      
      const iconMap = {
        success: 'fa-check-circle',
        error: 'fa-times-circle',
        warning: 'fa-exclamation-triangle'
      };
      
      notification.innerHTML = `
        <div class="notification-icon">
          <i class="fas ${iconMap[type]}"></i>
        </div>
        <div class="notification-content">
          <h4>${title}</h4>
          <p>${message}</p>
        </div>
      `;
      
      container.appendChild(notification);
      
      // Show notification
      setTimeout(() => notification.classList.add('show'), 10);
      
      // Auto remove
      setTimeout(() => {
        notification.classList.remove('show');
        setTimeout(() => notification.remove(), 500);
      }, 5000);
    }

    // Show login required message
    function showLoginRequired() {
      showNotification('Authentication Required', 'Please log in to continue', 'warning');
      setTimeout(() => {
        window.location.href = '/login';
      }, 2000);
    }

    // Set button loading state
    function setButtonLoading(button, loading) {
      if (loading) {
        button.classList.add('btn-loading');
        button.disabled = true;
        const icon = button.querySelector('i');
        if (icon) {
          const originalClass = icon.className;
          icon.setAttribute('data-original-class', originalClass);
          icon.className = 'fas fa-spinner fa-spin';
        }
      } else {
        button.classList.remove('btn-loading');
        button.disabled = false;
        const icon = button.querySelector('i');
        if (icon) {
          const originalClass = icon.getAttribute('data-original-class');
          if (originalClass) {
            icon.className = originalClass;
          }
        }
      }
    }

    // Fixed video preview function with 30-second limit
function playPreviewVideo(videoUrl, videoTitle) {
  console.log('playPreviewVideo called:', videoUrl, videoTitle);
  
  if (!videoUrl) {
    showNotification('Error', 'Video not available', 'error');
    return;
  }
  
  // Open video in a popup window
  const popup = window.open('', 'videoPreview', 'width=800,height=500,scrollbars=no,resizable=yes');
  
  // Use innerHTML instead of document.write to avoid syntax issues
  popup.document.body.innerHTML = `
    <html>
      <head>
        <title>Free Preview: ${videoTitle}</title>
        <style>
          body { 
            margin: 0; 
            padding: 15px; 
            background: #000; 
            font-family: Arial, sans-serif;
          }
          .header {
            background: linear-gradient(135deg, #002147 0%, #b8860b 100%);
            color: white;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 15px;
            text-align: center;
          }
          .preview-badge {
            background: #28a745;
            color: white;
            padding: 5px 15px;
            border-radius: 15px;
            font-size: 12px;
            display: inline-block;
            margin-bottom: 10px;
          }
          .timer-badge {
            background: #dc3545;
            color: white;
            padding: 5px 15px;
            border-radius: 15px;
            font-size: 12px;
            display: inline-block;
            margin-left: 10px;
            font-weight: bold;
          }
          video { 
            width: 100%; 
            height: 400px; 
            border-radius: 8px;
          }
          .video-overlay {
            position: relative;
            display: inline-block;
            width: 100%;
          }
          .time-remaining {
            position: absolute;
            top: 10px;
            right: 10px;
            background: rgba(220, 53, 69, 0.9);
            color: white;
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 14px;
            font-weight: bold;
            z-index: 10;
          }
          .cta {
            background: linear-gradient(135deg, #b8860b 0%, #9a7209 100%);
            color: white;
            padding: 15px;
            border-radius: 8px;
            margin-top: 15px;
            text-align: center;
          }
          .cta button {
            background: white;
            color: #b8860b;
            border: none;
            padding: 10px 25px;
            border-radius: 25px;
            font-weight: 600;
            cursor: pointer;
            margin-top: 10px;
            animation: pulse 2s infinite;
          }
          @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
          }
          .preview-ended {
            text-align: center;
            padding: 50px 20px;
            background: linear-gradient(135deg, #dc3545 0%, #c82333 100%);
            color: white;
            border-radius: 8px;
            margin: 15px 0;
          }
        </style>
      </head>
      <body>
        <div class="header">
          <div class="preview-badge">🎬 FREE PREVIEW</div>
          <div class="timer-badge" id="timerBadge">⏱️ 30 SECONDS ONLY</div>
          <h2 style="margin: 0;">${videoTitle}</h2>
        </div>
        
        <div class="video-overlay" id="videoContainer">
          <div class="time-remaining" id="timeRemaining">30s remaining</div>
          <video id="previewVideo" controls>
            <source src="${videoUrl}" type="video/mp4">
            Your browser does not support video playback.
          </video>
        </div>
        
        <div class="cta">
          <h3 style="margin: 0 0 10px 0;">🚀 Want to see the complete video?</h3>
          <p style="margin: 0 0 10px 0;">Unlock full access to this video and many others!</p>
          <button onclick="enrollNow()">
            💎 Enroll Now - Full Access!
          </button>
        </div>
      </body>
    </html>
  `;

  // Add the JavaScript functionality after the HTML is loaded
  setTimeout(() => {
    const script = popup.document.createElement('script');
    script.textContent = `
      let timeLeft = 30;
      let timer;
      let video = document.getElementById('previewVideo');
      let timeDisplay = document.getElementById('timeRemaining');
      let timerBadge = document.getElementById('timerBadge');
      
      function enrollNow() {
        if (window.opener && window.opener.scrollToEnrollment) {
          window.opener.scrollToEnrollment();
        }
        window.close();
      }
      
      function startTimer() {
        if (!timer) {
          timer = setInterval(function() {
            timeLeft--;
            if (timeDisplay) timeDisplay.textContent = timeLeft + 's remaining';
            if (timerBadge) timerBadge.textContent = '⏱️ ' + timeLeft + ' SECONDS LEFT';
            
            if (timeLeft <= 0) {
              endPreview();
            }
          }, 1000);
        }
      }
      
      function endPreview() {
        if (timer) clearInterval(timer);
        
        if (video) {
          video.pause();
          video.style.display = 'none';
        }
        
        const container = document.getElementById('videoContainer');
        if (container) {
          container.innerHTML = 
            '<div class="preview-ended">' +
              '<h3>🎬 Preview Complete!</h3>' +
              '<p style="margin: 10px 0;">You have seen the first 30 seconds of this lesson.</p>' +
              '<p style="margin: 10px 0; font-size: 18px; font-weight: bold;">Ready to see the rest?</p>' +
              '<button onclick="enrollNow()" style="background: white; color: #dc3545; border: none; padding: 12px 30px; border-radius: 25px; font-weight: 600; cursor: pointer; margin-top: 15px;">' +
                '🔓 Unlock Full Course Now!' +
              '</button>' +
            '</div>';
        }
      }
      
      if (video) {
        // Start timer when video plays
        video.addEventListener('play', startTimer);
        
        // Also limit by actual video time
        video.addEventListener('timeupdate', function() {
          if (video.currentTime >= 30) {
            endPreview();
          }
        });
        
        // Prevent seeking beyond 30 seconds
        video.addEventListener('seeked', function() {
          if (video.currentTime > 30) {
            video.currentTime = 30;
            endPreview();
          }
        });
        
        // Try to auto-play
        video.play().catch(function(error) {
          console.log('Auto-play prevented:', error);
        });
      }
    `;
    popup.document.head.appendChild(script);
  }, 100);
}

    // Scroll to enrollment section
    function scrollToEnrollment() {
      console.log('scrollToEnrollment called');
      
      // Scroll to the top where the purchase options are
      const heroActions = document.querySelector('.hero-actions');
      if (heroActions) {
        heroActions.scrollIntoView({ 
          behavior: 'smooth', 
          block: 'center' 
        });
        
        // Add a subtle highlight effect
        heroActions.style.animation = 'highlight-pulse 2s ease-in-out';
        setTimeout(() => {
          heroActions.style.animation = '';
        }, 2000);
      }
    }

    // Add highlight animation CSS
    const highlightStyle = document.createElement('style');
    highlightStyle.textContent = `
      @keyframes highlight-pulse {
        0% { box-shadow: 0 0 0 0 rgba(184, 134, 11, 0.7); }
        50% { box-shadow: 0 0 0 20px rgba(184, 134, 11, 0.2); }
        100% { box-shadow: 0 0 0 0 rgba(184, 134, 11, 0); }
      }
    `;
    document.head.appendChild(highlightStyle);

    // Add to Cart
    document.querySelectorAll('.add-to-cart-btn').forEach(button => {
      button.addEventListener('click', async function(e) {
        e.preventDefault();
        
        const courseId = this.getAttribute('data-course-id');
        const courseType = this.getAttribute('data-course-type');
        const courseTitle = this.getAttribute('data-course-title');
        
        setButtonLoading(this, true);
        
        try {
          const response = await fetch('/add-to-cart', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ courseId, courseType })
          });
          
          const result = await response.json();
          
          if (result.success) {
            showNotification('Added to Cart', `"${courseTitle}" has been added to your cart`, 'success');
          } else {
            showNotification('Error', result.message, 'error');
          }
        } catch (error) {
          console.error('Error:', error);
          showNotification('Error', 'Failed to add to cart', 'error');
        } finally {
          setButtonLoading(this, false);
        }
      });
    });

    // Add to Wishlist
    document.querySelectorAll('.add-to-wishlist-btn').forEach(button => {
      button.addEventListener('click', async function(e) {
        e.preventDefault();
        
        const courseId = this.getAttribute('data-course-id');
        const courseType = this.getAttribute('data-course-type');
        const courseTitle = this.getAttribute('data-course-title');
        
        setButtonLoading(this, true);
        
        try {
          const response = await fetch('/add-to-wishlist', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ courseId, courseType })
          });
          
          const result = await response.json();
          
          if (result.success) {
            showNotification('Added to Wishlist', `"${courseTitle}" has been saved to your wishlist`, 'success');
            
            // Optional: Update button appearance
            this.style.color = '#e74c3c';
            this.querySelector('i').classList.add('fas');
            this.querySelector('i').classList.remove('far');
          } else {
            showNotification('Error', result.message, 'error');
          }
        } catch (error) {
          console.error('Error:', error);
          showNotification('Error', 'Failed to add to wishlist', 'error');
        } finally {
          setButtonLoading(this, false);
        }
      });
    });

    // FAQ Toggle
    function toggleFaq(element) {
      const faqItem = element.parentElement;
      const wasActive = faqItem.classList.contains('active');
      
      // Close all FAQ items
      document.querySelectorAll('.faq-item').forEach(item => {
        item.classList.remove('active');
      });
      
      // Open clicked item if it wasn't active
      if (!wasActive) {
        faqItem.classList.add('active');
      }
    }

    // Smooth scroll for anchor links
    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
      anchor.addEventListener('click', function (e) {
        e.preventDefault();
        const target = document.querySelector(this.getAttribute('href'));
        if (target) {
          target.scrollIntoView({
            behavior: 'smooth',
            block: 'start'
          });
        }
      });
    });

    // Initialize and test
    console.log('📚 Self-paced course details page loaded');
    console.log('👤 User logged in:', <%= user ? 'true' : 'false' %>);
    console.log('🎥 Course ID:', '<%= course._id %>');
    console.log('💰 Course price:', <%= course.access?.price || course.price || 0 %>);
    console.log('📹 Videos available:', <%= course.videos?.length || 0 %>);
    
    // Test preview function
    console.log('playPreviewVideo function:', typeof playPreviewVideo);
    console.log('scrollToEnrollment function:', typeof scrollToEnrollment);
</script>

  <%- include('partials/footer') %>
</body>
</html>